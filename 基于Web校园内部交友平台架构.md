##基于web校园内部交友平台应用架构
1. **背景**  
我们要实现的web校园内部交友平台是强调同学们之间的互动性的，如果采用传统的开发技术，会存在网站缺乏互动，学生参与性差等特点。而且采用传统的ASP、JSP等技术开发的网站，在动态页面中会嵌套有大量的业务逻辑程序代码，这会大大增加页面维护的难度，同时它的可重用度低，扩展性也差。  
2. **模型选择**  
为了解决上述问题，我们选择目前广泛流行的web应用架构模式——MVC（模型—视图—控制器）模式。在这种开发框架之下，我们将校园交友平台的数据、业务逻辑、控制以及页面展现分离，各自处理自己的任务，这样会大大提高应用的可扩展性和易维护性。  
在实现中，用户请求被发送到一个控制器servlet，该servlet决定请求的性质，并且根据请求的类型传送给适合的处理逻辑。每个处理逻辑都和一个特别的模型相关，里面封装有相关逻辑来执行一些特别的函数集合。处理完毕后，结果会发送回控制器，控制器选择适合的视图显示它。模型、视图与控制器的分离，使得一个模型可以具有多个显示视图，无论何时发生了何种数据变化，控制器都将通知所有的视图并进行更行。
3. **基于MVC模式的校园内部交友平台设计与实现**  
3.1 **Struts与MVC**  
由于MVC模式采用了一个比较复杂的系统结构，所以采用MVC模式实现Web应用时，直接开发势必事倍功半。如果能在某个现有的MVC框架下进行开发，将达到事半功倍的效果。纵观目前在开源社区中采用MVC模式的开源框架，Struts是一个不错的选择。Struts框架如下：  

![](https://github.com/fengbobo/web/blob/master/picture/MVC1.png?raw=true "MVC")  

在这个框架之下，主要用JSP来创建视图，比如说登录界面、留言板界面等等，同时使用Struts自带的自定义标签库来简化用户界面的创建过程；使用ActionForm Bean来创建模型；运用ActionServlet来实现控制器；用Action、ActionMapping和ActionForward来协调完成业务逻辑。  
一个简单的基于Struts的响应时序如下：  

![](https://github.com/fengbobo/web/blob/master/picture/MVC2.png?raw=true "MVC2")  

①首先在Veiw层的JSP页面中提交一个请求。  
②在Control层的Controller对象根据请求的类型来调用相应的业务处理逻辑。  
③在Model层的事物类主要实现请求的业务功能。  
④把业务处理结果保存在数据库中并把响应信息保存在request中。  
⑤Control层的Controller对象根据上一步骤的返回值进行页面转发。  
⑥转发到View层的JSP页面，这个页面从request中取得结果并进行显示。  
⑦JSP页面中的代码只是用于显示结果，并没有涉及到任何业务逻辑。  
**3.1.1MVC在交友平的应用**  
首先介绍下MVC模式的模式：  
在MVC模式钟，他是一个循环的，Control交给Model然后再给View再继续循环，在后面会详细介绍。  

![](https://github.com/fengbobo/web/blob/master/picture/MVC3.png?raw=true "MVC3")  

其实在我们用MVC来解决校园交友平台的时候，我们是一个封闭的环，让我们的操作变得更为系统和方便。  
用户在输入要做的事情，传递给Control，然后Control根据指令传递给模型Model，模型在根据逻辑判断解决问题，并选择出适合的试图View，将结果反馈给用户，用户得到反馈之后继续下一步操作，这是MVC模式的一个常规循环，在我们的平台上，我们根据这个模型来做，使得更为规范和安全。  

![](https://github.com/fengbobo/web/blob/master/picture/MVC4.png?raw=true "MVC4")  

**3.2校园内部交友平台的表示层设计**  
       表示层接受用户提交的输入请求，通过控制器将其转化为相应的动作，获得输出并向用户展示。  
       采用MVC设计模式，由Servlet 提供页面请求和请求响应的总体控制，JSP 和浏览器提供请求结果响应的可视化显示。  

**3.3校园内部交友平台的控制器设计（业务逻辑）**  
控制器是模型与视图的联系纽带，控制器提取通过视图传输进来的外部信息，并将用户与View的交互转换为基于应用程序行为的标准业务事件，再将标准业务事件解析为Model应执行的动作。我们想要实现的校园内部交友平台采用Struts框架实现，因此控制器设计是整个系统设计的核心，控制器的组织方式决定了整个系统的框架。校园交友平台采用以下控制器设计方案（6个Action类）：  
1. 用户登录  
负责用户选择登录时页面的跳转。根据用户身份的不同跳转至普通用户或者管理员的页面。它还可以负责新用户的注册。  
2. 用户管理  
负责管理员操作界面的响应跳转。实现功能包括管理用户信息，管理聊天记录等等。  
3. 用户空间管理  
负责用户对自己空间处理的页面跳转。支持用户发表日志，修改日志，管理留言板等功能。  
4. 好友搜索  
负责用户进行好友搜索时的页面跳转。用户根据标签进行检索，控制器将符合条件的检索结果反馈给用户。  
5. 讨论组管理  
负责用户在讨论组里进行操作时的页面跳转。实现聊天信息的广播，共享资源的检索等。  
6. 评论管理  
负责所有有关评论的操作。  
**3.4校园内部交友平台的持久层设计**  
   由于MVC模式采用了良好的体系结构，所以可以将持久层分离出来，使得系统具有极佳的移植性和复用性。校园内部交友平台采用的持久层设计方案，可以将它们映射为关系数据库的表，采用JDBC连接池方式实现；或者采用其他的持久层解决方案。具体对象如下：  
1. 管理员信息（管理人员ID，管理人员姓名，管理人员密码，是否注销）  
2. 用户信息（用户ID，用户昵称，用户密码，用户Email，性别，年龄，生日，是否在线，爱好，头像路径）  
3. 资源信息（资源ID，资源所属相册，照片地址，是否删除）  
4. 相册信息（相册ID，相册名，资源用户ID，是否删除）  
5. 评论信息（评论ID，相片ID，日志ID，说说ID，评论内容，评论时间，时候删除）  
6. 好友信息（好友ID，用户，用户的好友，是否删除，是否接受，是否是更新的）  
7. 访问记录信息（访问ID，访问人，被访问人，访问时间）  
8. 日志信息（日志ID，日志作者，标题，内容，创建时间，是否删除）  
9. 说说信息（说说ID，说说作者，内容，创建时间，是否删除）  

 主要功能：数据创建、数据存储、数据查询、数据更新、数据删除、数据安全、数据备份/恢复。  
   与其他层接口：  
1)数据库方式的数据层面向业务逻辑层提供数据库访问服务接口，业务逻辑层通过JDBC 协议访问数据库服务。  
2)文件方式的数据层面向业务逻辑层提供文件级的访问服务接口，业务逻辑层通过操作系统本身提供的文件访问API、访问文件数据。  

4. 结语  
总之，基于MVC架构的校园内部交友平台可以很好地解决交互性差、难扩展、难维护的问题。同时由于不同层各司其职，有利于管理代码。而且对于存在大量用户界面的校园内部交友平台来说，我们使用的MVC架构可以达到多个视图共享一个模型的效果，这样大大提高了灵活性。这些对于后期的开发、维护都是十分有利的。
